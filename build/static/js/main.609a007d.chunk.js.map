{"version":3,"sources":["logo.svg","components/BabylonScene.js","components/Playground.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","window","earcut","BabylonScene","onResizeWindow","engine","resize","onCanvasLoaded","c","canvas","preventDefault","e","onwheel","onmousewheel","focus","onKeyDown","props","onKeyUp","this","Engine","antialias","engineOptions","adaptToDeviceRatio","scene","Scene","onSceneMount","runRenderLoop","onRender","render","addEventListener","removeEventListener","ref","style","width","height","outline","React","Component","defaultProps","SHOW_WORLD_AXIS","Playground","gravityVector","Vector3","physicsPlugin","CannonJSPlugin","enablePhysics","camera","createCamera","createSky","createDirectionalLight","createHemisphericLight","createStaticMesh","showWorldAxis","size","loadModels","concreteMaterial","createConcreteMaterial","pbr","createBricksMaterial","land","createGround","createFloor","ceiling","createCeiling","createLeftWall","createRightWall","createBackWall","createFrontWall","platform","createPlatform","egg","createEgg","player","createSphere","onSphereHitEgg","main","collided","physicsImpostor","dispose","parent","position","onSphereHitGround","changeModel","walking","Math","abs","getLinearVelocity","y","touching","onSpacePressed","flapping","boost","getBoost","console","log","applyImpulse","keyDirection","getAbsolutePosition","resetPosAndAngle","key","rotatePlayer","friction","accelerateInterval","self","setInterval","accelerate","apply","getChildren","includes","x","setEggImpostor","z","vel","setLinearVelocity","setAngularVelocity","rotation","clearInterval","flying","LinesBuilder","CreateLines","points","Zero","color","Color3","levelHeight","levelWidth","levelDepth","ArcRotateCamera","PI","fov","minZ","skyMaterial","SkyMaterial","backFaceCulling","luminance","inclination","azimuth","BoxBuilder","CreateBox","material","direct","DirectionalLight","sg","ShadowGenerator","usePoissonSampling","HemisphericLight","intensity","light","PointLight","light2","GroundBuilder","CreateGround","sideOrientation","Mesh","DOUBLESIDE","PhysicsImpostor","PlaneImpostor","mass","restitution","stiffness","visibility","faceUV","getBoxWrapUV","floor","depth","receiveShadows","defaultMaterial","StandardMaterial","diffuseColor","BoxImpostor","leftWall","rightWall","PBRMaterial","forceIrradianceInFragment","albedoTexture","Texture","bumpTexture","useRoughnessFromMetallicTextureAlpha","useRoughnessFromMetallicTextureGreen","useMetallnessFromMetallicTextureBlue","metallicTexture","invertNormalMapX","invertNormalMapY","CreateGroundFromHeightMap","subdivisions","maxHeight","onReady","backWall","tmpBackWall","newWall","createInstance","wallHeight","frontWall","PlaneBuilder","CreatePlane","BACKSIDE","textureSize","Array","i","Vector4","getShadowMap","renderList","push","SphereBuilder","CreateSphere","diameter","segments","direction","lastQuaternion","model","rotationQuaternion","axis","angle","quaternion","Quaternion","RotationAxis","assetsNum","SceneLoader","ImportMesh","meshes","walkingLeft","checkAssets","message","running","addChild","SphereImpostor","registerOnPhysicsCollide","isNotSpeeding","isTouchingGround","App","Boolean","location","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.609a007d.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.25bf045c.svg\";","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Engine } from '@babylonjs/core/Engines/engine'\r\nimport { Scene } from '@babylonjs/core/scene'\r\n\r\n// pepjs needed for babylon touch event\r\nimport 'pepjs'\r\n\r\n// earcut needed by babylon's polygon extruder\r\nimport earcut from 'earcut'\r\nwindow.earcut = earcut\r\n\r\nclass BabylonScene extends React.Component {\r\n  static propTypes = {\r\n    engineOptions: PropTypes.object,\r\n    antialias: PropTypes.bool,\r\n    adaptToDeviceRatio: PropTypes.bool,\r\n    onSceneMount: PropTypes.func.isRequired,\r\n    onKeyDown: PropTypes.func.isRequired,\r\n    onRender: PropTypes.func.isRequired,\r\n    onKeyUp: PropTypes.func.isRequired\r\n  }\r\n\r\n  static defaultProps = {\r\n    antialias: true,\r\n    adaptToDeviceRatio: false\r\n  }\r\n\r\n  componentDidMount () {\r\n    // setup engine\r\n    this.engine = new Engine(\r\n      this.canvas,\r\n      this.props.antialias,\r\n      this.props.engineOptions,\r\n      this.props.adaptToDeviceRatio\r\n    )\r\n    // create scene\r\n    this.scene = new Scene(this.engine)\r\n    \r\n    // call scene mounted handler\r\n    this.props.onSceneMount({\r\n      scene: this.scene,\r\n      engine: this.engine,\r\n      canvas: this.canvas\r\n    });\r\n    // start render loop\r\n    this.engine.runRenderLoop(() => {\r\n      if (this.scene) {\r\n        this.props.onRender();\r\n        this.scene.render()\r\n      }\r\n    })\r\n    // handle resize\r\n    window.addEventListener('resize', this.onResizeWindow)\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    window.removeEventListener('resize', this.onResizeWindow)\r\n  }\r\n\r\n  onResizeWindow = () => {\r\n    if (this.engine) {\r\n      this.engine.resize()\r\n    }\r\n  }\r\n\r\n  onCanvasLoaded = c => {\r\n    if (c !== null) {\r\n      this.canvas = c\r\n      // avoid page scrolling\r\n      const preventDefault = e => e.preventDefault()\r\n      this.canvas.onwheel = preventDefault\r\n      this.canvas.onmousewheel = preventDefault\r\n      this.canvas.focus();\r\n    }\r\n  }\r\n  onKeyDown = (e) => {\r\n    this.props.onKeyDown(e);\r\n  }\r\n  onKeyUp = (e) => {\r\n    this.props.onKeyUp(e);\r\n  }\r\n  render () {\r\n    return (\r\n      <canvas\r\n        ref={this.onCanvasLoaded}\r\n        onKeyDown={this.onKeyDown}\r\n        onKeyUp={this.onKeyUp}\r\n        style={{ width: '100%', height: '100%', outline: 'none' }}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport default BabylonScene\r\n","import React from 'react'\r\n//import * as cannon from 'cannon';\r\nimport { CannonJSPlugin } from '@babylonjs/core/Physics/Plugins/cannonJSPlugin'\r\nimport { PhysicsImpostor } from '@babylonjs/core/Physics/physicsImpostor'\r\nimport { Vector3, Color3,Vector4,Quaternion } from '@babylonjs/core/Maths/math'\r\nimport { ArcRotateCamera } from '@babylonjs/core/Cameras/arcRotateCamera'\r\nimport { DirectionalLight } from '@babylonjs/core/Lights/directionalLight'\r\nimport { PointLight } from '@babylonjs/core/Lights/pointLight'\r\nimport { HemisphericLight } from '@babylonjs/core/Lights/hemisphericLight'\r\nimport { ShadowGenerator } from '@babylonjs/core/Lights/Shadows/shadowGenerator'\r\nimport { ShadowGeneratorSceneComponent } from '@babylonjs/core/Lights/Shadows/shadowGeneratorSceneComponent'\r\nimport {SceneLoader} from '@babylonjs/core/Loading/';\r\n\r\n\r\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\r\nimport { PBRMaterial } from '@babylonjs/core/Materials/PBR/pbrMaterial'\r\nimport { PBRMetallicRoughnessMaterial } from '@babylonjs/core/Materials/PBR/pbrMetallicRoughnessMaterial'\r\nimport { Texture } from '@babylonjs/core/Materials/Textures/texture'\r\n\r\nimport { LinesBuilder } from '@babylonjs/core/Meshes/Builders/linesBuilder'\r\nimport { PlaneBuilder } from '@babylonjs/core/Meshes/Builders/planeBuilder'\r\nimport { GroundBuilder } from '@babylonjs/core/Meshes/Builders/groundBuilder'\r\n\r\nimport { SphereBuilder } from '@babylonjs/core/Meshes/Builders/sphereBuilder'\r\nimport { BoxBuilder } from '@babylonjs/core/Meshes/Builders/boxBuilder'\r\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\r\n\r\nimport { SkyMaterial } from '@babylonjs/materials/sky'\r\n// required babylon side effects\r\nimport '@babylonjs/core/Animations/animatable'\r\nimport '@babylonjs/core/Physics/physicsEngineComponent'\r\n\r\n\r\nimport BabylonScene from './BabylonScene'\r\n\r\nconst SHOW_WORLD_AXIS = false;\r\nconst ATTACH_CAMERA = true;\r\n\r\nclass Playground extends React.Component{\r\n  constructor(props){\r\n    super(props);\r\n    this.keyDirection = 0;\r\n    this.touching = true;\r\n    this.levelHeight = 40;\r\n    this.levelWidth = 150;\r\n    this.levelDepth = 4;\r\n  }\r\n\r\n  \r\n  // scene setup\r\n  onSceneMount = ({ canvas, scene, engine }) => {\r\n    window.scene = scene // for debug\r\n    this.scene = scene;\r\n    var gravityVector = new Vector3(0,-9.81, 0);\r\n    var physicsPlugin = new CannonJSPlugin();\r\n    scene.enablePhysics(gravityVector, physicsPlugin);\r\n    // camera\r\n    this.camera = this.createCamera(scene,canvas);\r\n    // sky (https://doc.babylonjs.com/extensions/sky)\r\n    this.createSky(scene);\r\n    // create light\r\n    //this.createLights(scene);\r\n    this.createDirectionalLight(scene);\r\n    this.createHemisphericLight(scene);\r\n    // scene\r\n    this.createStaticMesh({ scene })\r\n    // debug\r\n    if (SHOW_WORLD_AXIS) {\r\n      this.showWorldAxis({ size: 5, scene })\r\n    }\r\n  }\r\n\r\n  \r\n\r\n  createCamera(scene,canvas){\r\n    const camera = new ArcRotateCamera(\r\n      'arc-camera',\r\n      -Math.PI/2,\r\n      Math.PI/2,\r\n      60,\r\n      new Vector3(0,0,0),\r\n      scene\r\n    )\r\n    camera.fov = 0.6;\r\n    if(!ATTACH_CAMERA){\r\n      camera.setTarget(Vector3.Zero())\r\n      camera.attachControl(canvas, true)\r\n    }\r\n    camera.minZ = 0;\r\n    //camera.keysUp = [];camera.keysDown = [];\r\n    return camera;\r\n  }\r\n\r\n  createSky(scene){\r\n    const skyMaterial = new SkyMaterial('sky-material', scene)\r\n    skyMaterial.backFaceCulling = false\r\n    skyMaterial.luminance = 0.8\r\n    skyMaterial.inclination = 0.18\r\n    skyMaterial.azimuth = 0.27\r\n    const skybox = BoxBuilder.CreateBox('skybox', { size: 1000 }, scene)\r\n    skybox.material = skyMaterial\r\n  }\r\n\r\n  createDirectionalLight(scene){\r\n    const direct = new DirectionalLight(\"direct\",new Vector3(-1,-3,3),scene);\r\n    direct.position = new Vector3(10,this.levelHeight,-10);\r\n    this.sg = new ShadowGenerator(1024,direct);\r\n    this.sg.usePoissonSampling = true;\r\n  }\r\n\r\n  createHemisphericLight(scene){\r\n    const hemi = new HemisphericLight(\"hemi\",new Vector3(1,2,1),scene);\r\n    hemi.intensity = 0.3;\r\n  }\r\n\r\n  createLights(scene){\r\n    const light = new PointLight('light', new Vector3(this.levelWidth*3/4, 9, -200), scene)\r\n    const light2 = new PointLight('light', new Vector3(-this.levelWidth*3/4, 32, -200), scene)\r\n    light.intensity = .7\r\n    light2.intensity = 0.3\r\n  }\r\n\r\n  createStaticMesh = ({ scene }) => {\r\n    this.loadModels(scene);\r\n    this.concreteMaterial = this.createConcreteMaterial(scene);\r\n    this.pbr = this.createBricksMaterial(scene);\r\n    this.land = this.createGround(scene);\r\n    this.createFloor(scene);\r\n    this.ceiling = this.createCeiling(scene);\r\n    this.createLeftWall(scene);\r\n    this.createRightWall(scene);\r\n    this.createBackWall(scene);\r\n    this.createFrontWall(scene);\r\n    this.platform = this.createPlatform(scene);    \r\n    this.egg = this.createEgg(scene);\r\n    this.player = this.createSphere(scene);\r\n    //this.setEggImpostor();\r\n  }\r\n\r\n  createGround(scene){\r\n    const land = GroundBuilder.CreateGround(\r\n      'land',\r\n      { width: this.levelWidth,height: this.levelDepth, sideOrientation: Mesh.DOUBLESIDE },\r\n      scene\r\n    );\r\n    //land.material = defaultMaterial;\r\n    land.physicsImpostor = new PhysicsImpostor(land,PhysicsImpostor.PlaneImpostor,{mass:0, restitution: 0,stiffness:0,friction:1}, scene);\r\n    land.visibility = 0;\r\n    return land;\r\n  }\r\n\r\n  createFloor(scene){\r\n    const faceUV = this.getBoxWrapUV(this.levelWidth,2,this.levelDepth,5);\r\n    const floor = BoxBuilder.CreateBox(\r\n      'land',\r\n      { width: this.levelWidth,height: 2, sideOrientation: Mesh.DOUBLESIDE ,depth:this.levelDepth,faceUV:faceUV},\r\n      scene\r\n    )\r\n    //floor.rotation.x = Math.PI/2;\r\n    floor.position.y = -1;\r\n    floor.material = this.concreteMaterial;\r\n    floor.receiveShadows = true;\r\n  }\r\n\r\n  createCeiling(scene){\r\n    const defaultMaterial = new StandardMaterial('default-material', scene)\r\n    defaultMaterial.diffuseColor = new Color3(1, 1, 1)\r\n    const ceiling = BoxBuilder.CreateBox(\r\n      'ceiling',\r\n      { width: this.levelWidth,depth: this.levelDepth,height: 0.2 },\r\n      scene\r\n    )\r\n    \r\n    ceiling.position.y = 40;\r\n    ceiling.material = defaultMaterial;\r\n    ceiling.physicsImpostor = new PhysicsImpostor(ceiling,PhysicsImpostor.BoxImpostor,{mass:0}, scene);\r\n    return ceiling;\r\n  }\r\n\r\n  createLeftWall(scene){\r\n    const defaultMaterial = new StandardMaterial('default-material', scene)\r\n    defaultMaterial.diffuseColor = new Color3(1, 1, 1)\r\n    const leftWall = BoxBuilder.CreateBox(\r\n      'leftWall',\r\n      { width: this.levelHeight,depth: this.levelDepth,height: 0.2 },\r\n      scene\r\n    )\r\n    leftWall.rotation.z = Math.PI/2;\r\n    leftWall.position.y = 20;\r\n    leftWall.position.x = -this.levelWidth/2;\r\n    leftWall.material = defaultMaterial;\r\n    leftWall.physicsImpostor = new PhysicsImpostor(leftWall,PhysicsImpostor.BoxImpostor,{mass:0, restitution: 0.9}, scene);\r\n    leftWall.receiveShadows = true;\r\n  }\r\n\r\n  createRightWall(scene){\r\n    const defaultMaterial = new StandardMaterial('default-material', scene)\r\n    defaultMaterial.diffuseColor = new Color3(1, 1, 1)\r\n    const rightWall = BoxBuilder.CreateBox(\r\n      'rightWall',\r\n      { width: this.levelHeight,depth: this.levelDepth,height: 0.2 },\r\n      scene\r\n    )\r\n    rightWall.rotation.z = Math.PI/2;\r\n    rightWall.position.y = 20;\r\n    rightWall.position.x = this.levelWidth/2;\r\n    rightWall.material = defaultMaterial;\r\n    rightWall.physicsImpostor = new PhysicsImpostor(rightWall,PhysicsImpostor.BoxImpostor,{mass:0, restitution: 0.9}, scene);\r\n    rightWall.receiveShadows = true;\r\n  }\r\n\r\n  createBricksMaterial(scene){\r\n    const pbr = new PBRMaterial('bricks', scene);\r\n    pbr.forceIrradianceInFragment = true;\r\n    pbr.albedoTexture = new Texture(\"textures/bricks_rustic_albedo.png\", scene);\r\n    pbr.bumpTexture = new Texture(\"textures/bricks_rustic_normal.png\", scene);\r\n    pbr.useRoughnessFromMetallicTextureAlpha = false;\r\n    pbr.useRoughnessFromMetallicTextureGreen = true;\r\n    pbr.useMetallnessFromMetallicTextureBlue = true;\r\n    pbr.metallicTexture = new Texture(\"textures/bricks_rustic_metallic_roughness.png\", scene);\r\n    pbr.invertNormalMapX = true;\r\n    pbr.invertNormalMapY = true;\r\n    return pbr;\r\n  }\r\n\r\n  createBackWall(scene){\r\n    let wallWidth = 20;\r\n    let wallHeight = 20;\r\n    const backWall = GroundBuilder.CreateGroundFromHeightMap(\r\n      'backWall','textures/bricks_rustic_height.png',\r\n      { height:  wallHeight,width:wallWidth,\r\n        subdivisions:200,maxHeight:0.2,\r\n        onReady:(backWall)=>{\r\n          backWall.rotation.x= -Math.PI/2;\r\n    \r\n          backWall.material = this.pbr;\r\n          backWall.receiveShadows = true;\r\n          let tmpBackWall = new Mesh(\"tmpBackWall\",scene);\r\n          for(let x = 0;x<this.levelWidth;x += wallWidth){\r\n            for(let y = 0;y<this.levelHeight;y += wallHeight){\r\n              if(x === 0 && y === 0){\r\n                backWall.parent = tmpBackWall;\r\n                backWall.position = new Vector3(x,y,0);\r\n              }else{\r\n                let newWall = backWall.createInstance(\"wallTile\"+x+\"_\"+y);\r\n                newWall.parent = tmpBackWall;\r\n                newWall.position = new Vector3(x,y,0);\r\n              }\r\n            }\r\n          }\r\n          tmpBackWall.position.z = this.levelDepth/2;\r\n          tmpBackWall.position.y = this.levelHeight/2 - wallHeight/2;\r\n          tmpBackWall.position.x= -this.levelWidth/2;\r\n          tmpBackWall.physicsImpostor = new PhysicsImpostor(tmpBackWall,PhysicsImpostor.BoxImpostor,{mass:0, restitution: 0.1,friction:0.01}, scene);\r\n        }\r\n      },\r\n      scene\r\n    );\r\n    \r\n  }\r\n\r\n  createFrontWall(scene){\r\n    const frontWall = PlaneBuilder.CreatePlane(\r\n      'frontWall',\r\n      { height: this.levelWidth,width: this.levelHeight,sideOrientation: Mesh.BACKSIDE},\r\n      scene\r\n    )\r\n    frontWall.rotation.z= Math.PI/2;\r\n    frontWall.position.z = -this.levelDepth/2;\r\n    frontWall.position.y = this.levelHeight/2;\r\n    frontWall.physicsImpostor = new PhysicsImpostor(frontWall,PhysicsImpostor.BoxImpostor,{mass:0, restitution: 0.1,friction:0.01}, scene);\r\n  }\r\n\r\n  createConcreteMaterial(scene){\r\n    const pbr = new PBRMaterial('concrete', scene)\r\n    pbr.forceIrradianceInFragment = true;\r\n    pbr.albedoTexture = new Texture(\"textures/concrete_worn_albedo.png\", scene);\r\n    pbr.bumpTexture = new Texture(\"textures/concrete_worn_normal.png\", scene);\r\n    pbr.useRoughnessFromMetallicTextureAlpha = false;\r\n    pbr.useRoughnessFromMetallicTextureGreen = true;\r\n    pbr.useMetallnessFromMetallicTextureBlue = true;\r\n    pbr.metallicTexture = new Texture(\"textures/concrete_worn_metallic_roughness.png\", scene);\r\n    pbr.invertNormalMapX = true;\r\n    pbr.invertNormalMapY = true;\r\n    return pbr;\r\n  }\r\n\r\n  getBoxWrapUV(width,height,depth,textureSize){\r\n    /*\r\n    side 0 faces the positive z direction\r\n    side 1 faces the negative z direction\r\n    side 2 faces the positive x direction\r\n    side 3 faces the negative x direction\r\n    side 4 faces the positive y direction\r\n    side 5 faces the negative y direction\r\n    */\r\n    var faceUV = new Array(6);\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n      if(i === 0 || i === 1){\r\n        faceUV[i] = new Vector4(0, 0,width/textureSize,height/textureSize);\r\n      }else if(i === 2 || i === 3){\r\n        faceUV[i] = new Vector4(0, 0,height/textureSize,depth/textureSize);\r\n      }else if(i === 4 || i === 5){\r\n        faceUV[i] = new Vector4(0, 0,depth/textureSize,width/textureSize);\r\n      }\r\n    }\r\n    return faceUV;\r\n  }\r\n\r\n  createPlatform(scene){\r\n    const width = 20;\r\n    const height = 2;\r\n    const faceUV = this.getBoxWrapUV(width,height,this.levelDepth,5);\r\n    const platform = BoxBuilder.CreateBox(\r\n      'ceiling',\r\n      { width: width,depth: this.levelDepth,height: height ,faceUV:faceUV},\r\n      scene\r\n    )\r\n    \r\n    platform.position.y = 10;\r\n    platform.material = this.concreteMaterial;\r\n    platform.physicsImpostor = new PhysicsImpostor(platform,PhysicsImpostor.BoxImpostor,{mass:0, restitution: 0.1,friction:0.01}, scene);\r\n    this.sg.getShadowMap().renderList.push(platform);\r\n    platform.receiveShadows = true;\r\n    return platform;\r\n  }\r\n\r\n  createEgg(scene){\r\n    const defaultMaterial = new StandardMaterial('default-material', scene)\r\n    defaultMaterial.diffuseColor = new Color3(1, 1, 1)\r\n    const egg = SphereBuilder.CreateSphere(\r\n      'egg',\r\n      { diameter: 1.5, segments: 16 },\r\n      scene\r\n    );\r\n    egg.material = defaultMaterial;\r\n    egg.position.y = 15;\r\n    //egg.position.z = -this.levelDepth/2;\r\n    this.sg.getShadowMap().renderList.push(egg);\r\n    return egg;\r\n  }\r\n\r\n  rotatePlayer(direction,lastQuaternion){\r\n    console.log(direction);\r\n    if(direction === 0) {\r\n      this.model.rotationQuaternion = lastQuaternion;\r\n    }else{\r\n      const axis = new Vector3(0, 1, 0);\r\n      const angle = direction * (Math.PI / 2) - (Math.PI / 2);\r\n      const quaternion = Quaternion.RotationAxis(axis, angle);\r\n      this.model.rotationQuaternion = quaternion;\r\n    }\r\n  }\r\n\r\n  loadModels(scene){\r\n    this.assetsNum = 4;\r\n    SceneLoader.ImportMesh('walking_left','models/','walking_left.babylon',scene,(meshes)=>{\r\n      this.walkingLeft = meshes[0];\r\n      this.checkAssets(this.walkingLeft);\r\n    },(e)=>console.log('progress'+e),(scene,message)=>console.log('error'+message));\r\n\r\n    SceneLoader.ImportMesh('flying','models/','flying.babylon',scene,(meshes)=>{\r\n      this.flying = meshes[0];\r\n      this.checkAssets(this.flying);\r\n    },(e)=>console.log('progress'+e),(scene,message)=>console.log('error'+message));\r\n\r\n    SceneLoader.ImportMesh('running','models/','running.babylon',scene,(meshes)=>{\r\n      this.running = meshes[0];\r\n      this.checkAssets(this.running);\r\n    },(e)=>console.log('progress'+e),(scene,message)=>console.log('error'+message));\r\n\r\n    SceneLoader.ImportMesh('flapping','models/','flapping.babylon',scene,(meshes)=>{\r\n      this.flapping = meshes[0];\r\n      this.checkAssets(this.flapping);\r\n    },(e)=>console.log('progress'+e),(scene,message)=>console.log('error'+message));\r\n        \r\n  }\r\n  checkAssets(model){\r\n    model.visibility = 0;\r\n    model.position.x = 5 * this.assetsNum;\r\n    model.position.y = 3.3;\r\n    this.sg.getShadowMap().renderList.push(model);\r\n    this.assetsNum--;\r\n    if(this.assetsNum === 0){\r\n      console.log(\"checkAssets finish\");\r\n    }\r\n  }\r\n  changeModel(model){\r\n    if(model === this.model){\r\n      return;\r\n    }\r\n    this.model.parent = null;\r\n    this.model.visibility = 0;\r\n    model.visibility = 1;\r\n    const lastQuaternion = this.model.rotationQuaternion;\r\n    this.model = model;\r\n    this.player.addChild(model);\r\n    model.position = new Vector3(0,0.3,0);\r\n    this.rotatePlayer(this.keyDirection,lastQuaternion);\r\n  }\r\n  createSphere(scene){\r\n    const player = BoxBuilder.CreateBox(\"sphere\",{width:4,height:6.1,depth:2},scene);\r\n    player.visibility = 0;\r\n    const loader = SceneLoader.ImportMesh('walking','models/','walking.babylon',scene,(meshes)=>{\r\n      const model = meshes[0];\r\n      model.receiveShadows = true;\r\n      model.position.y = 0.3;\r\n      /*const axis = new Vector3(0, 0, 0);\r\n      //axis = axis.normalize();\r\n      const angle = Math.PI / 8;\r\n      const quaternion = Quaternion.RotationAxis(axis, angle);\r\n      model.rotationQuaternion = quaternion;*/\r\n      this.walking = this.model = model;\r\n      player.addChild(model);\r\n      //this.camera.parent = null;\r\n      /*this.sphere.physicsImpostor.dispose();\r\n      this.sphere.dispose();*/\r\n      //model.parent = this.sphere;\r\n      player.position.y = 3;\r\n      player.physicsImpostor = new PhysicsImpostor(player,PhysicsImpostor.SphereImpostor,{mass:0.2,restitution: 0,friction:1,stiffness:0}, scene);\r\n      player.physicsImpostor.registerOnPhysicsCollide([this.platform.physicsImpostor,this.land.physicsImpostor], this.onSphereHitGround);\r\n      this.sg.getShadowMap().renderList.push(model);\r\n      this.setEggImpostor();\r\n    },(e)=>console.log('progress'+e),(scene,message)=>console.log('error'+message));    \r\n\r\n      if(ATTACH_CAMERA){\r\n        this.camera.parent = player;\r\n      }\r\n\r\n      //sphere.physicsImpostor = new PhysicsImpostor(sphere,PhysicsImpostor.SphereImpostor,{mass:0.2,restitution: 0,friction:1,stiffness:0}, scene);\r\n      \r\n    return player;\r\n  }\r\n\r\n  setEggImpostor(scene){\r\n    this.egg.physicsImpostor = new PhysicsImpostor(this.egg,PhysicsImpostor.SphereImpostor,{mass:1, restitution: 0.2,friction:0.3}, this.scene);\r\n    this.player.physicsImpostor.registerOnPhysicsCollide(this.egg.physicsImpostor, this.onSphereHitEgg);\r\n  }\r\n  onSphereHitEgg = (main, collided) => {\r\n    this.egg.physicsImpostor.dispose();\r\n    this.egg.parent = this.player;\r\n    this.egg.position = new Vector3((2+1.5)/2,0,0);\r\n  }\r\n  onSphereHitGround = (main, collided) => {\r\n    this.changeModel(this.walking);\r\n    if(Math.abs(this.player.physicsImpostor.getLinearVelocity().y) < 4){\r\n      \r\n      this.touching = true;\r\n    }\r\n  }\r\n  onSpacePressed = () =>{\r\n    this.changeModel(this.flapping);\r\n    //let horizImpulse = this.isNotSpeeding() ?this.keyDirection/2:0;\r\n    let boost = this.getBoost();\r\n    console.log(\"spacebar boost\"+boost);\r\n    this.player.physicsImpostor.applyImpulse(new Vector3(this.keyDirection*0.7*boost, 1, 0), this.player.getAbsolutePosition())\r\n    this.resetPosAndAngle();\r\n    this.touching = false;\r\n  }\r\n  getBoost(){\r\n    let vel = this.player.physicsImpostor.getLinearVelocity().x;\r\n    return vel/Math.abs(vel) === this.keyDirection ? 1 : 2;\r\n  }\r\n  isNotSpeeding(){\r\n    return this.player.physicsImpostor.getLinearVelocity().x*this.keyDirection < 7;\r\n  }\r\n  isTouchingGround(){\r\n    return this.touching;\r\n  }\r\n  onKeyDown = (e) => {\r\n    e.preventDefault();\r\n    if (e.key === \" \") {\r\n      this.onSpacePressed();\r\n    }else if(e.key === \"ArrowRight\"){\r\n\r\n      this.keyDirection = 1;\r\n      this.rotatePlayer(this.keyDirection);\r\n      this.player.physicsImpostor.friction = 0.1;\r\n      this.land.physicsImpostor.friction = 0.1;\r\n      if(!this.accelerateInterval){\r\n        let self = this;\r\n        this.accelerateInterval = setInterval(()=>{\r\n          //console.log(\"setInterval accelerate\");\r\n          self.accelerate.apply(self);\r\n        },200);\r\n      }\r\n    }else if(e.key === \"ArrowLeft\"){\r\n      this.keyDirection = -1;\r\n      this.rotatePlayer(this.keyDirection);\r\n      this.player.physicsImpostor.friction = 0.1;\r\n      this.land.physicsImpostor.friction = 0.1;\r\n      if(!this.accelerateInterval){\r\n        let self = this;\r\n        this.accelerateInterval = setInterval(()=>{\r\n          //console.log(\"setInterval accelerate\");\r\n          self.accelerate.apply(self);\r\n        },200);\r\n      }\r\n    }else if(e.key === \"AltGraph\"){\r\n      if(this.player.getChildren().includes(this.egg)){\r\n        console.log(\"AltGraph\");\r\n        this.egg.parent = null;\r\n        this.egg.position = this.player.getAbsolutePosition();\r\n        this.egg.position.x += 5*this.keyDirection;\r\n        this.setEggImpostor();\r\n        this.egg.position.z = 0;\r\n        let vel = this.egg.physicsImpostor.getLinearVelocity();\r\n        vel.z = 0;\r\n        this.egg.physicsImpostor.setLinearVelocity(vel);\r\n        this.egg.physicsImpostor.setAngularVelocity(new Vector3(0,0,0));\r\n        this.egg.rotation = new Vector3(0,0,0);\r\n        this.egg.physicsImpostor.applyImpulse(new Vector3(this.keyDirection*20, 0, 0), this.egg.getAbsolutePosition());\r\n\r\n      }\r\n    }\r\n  }\r\n  onKeyUp = (e) => {\r\n    e.preventDefault();\r\n    if(e.key === \"ArrowRight\" || e.key === \"ArrowLeft\"){\r\n      this.keyDirection = 0;\r\n      if(this.accelerateInterval){\r\n        console.log(\"clearInterval\");\r\n        clearInterval(this.accelerateInterval);\r\n        this.accelerateInterval = null;\r\n      }\r\n      this.player.physicsImpostor.friction = 1;\r\n      this.land.physicsImpostor.friction = 1;\r\n    }else if(e.key === \" \"){\r\n      this.changeModel(this.flying);\r\n    }\r\n  }\r\n  resetPosAndAngle = () => {\r\n    if(!this.player || !this.player.physicsImpostor){\r\n      return;\r\n    }\r\n    let vel = this.player.physicsImpostor.getLinearVelocity();\r\n    vel.z = 0;\r\n    this.player.physicsImpostor.setLinearVelocity(vel);\r\n    this.player.position.z = 0;\r\n    this.player.physicsImpostor.setAngularVelocity(new Vector3(0,0,0));\r\n    this.player.rotation = new Vector3(0,0,0);\r\n  }\r\n  accelerate(){\r\n    this.resetPosAndAngle();\r\n    if( this.keyDirection !== 0 &&\r\n        this.isNotSpeeding() &&\r\n        this.isTouchingGround() ){\r\n      let boost = this.getBoost();\r\n      this.player.physicsImpostor.applyImpulse(new Vector3(this.keyDirection*1*boost, 0, 0), this.player.getAbsolutePosition());\r\n    }\r\n  }\r\n\r\n  showWorldAxis = ({ size, scene }) => {\r\n    const axisX = LinesBuilder.CreateLines(\r\n      'axisX',\r\n      {\r\n        points: [Vector3.Zero(), new Vector3(size, 0, 0)]\r\n      },\r\n      scene\r\n    )\r\n    axisX.color = new Color3(1, 0, 0)\r\n    const axisY = LinesBuilder.CreateLines(\r\n      'axisY',\r\n      {\r\n        points: [Vector3.Zero(), new Vector3(0, size, 0)]\r\n      },\r\n      scene\r\n    )\r\n    axisY.color = new Color3(0, 1, 0)\r\n    const axisZ = LinesBuilder.CreateLines(\r\n      'axisZ',\r\n      {\r\n        points: [Vector3.Zero(), new Vector3(0, 0, size)]\r\n      },\r\n      scene\r\n    )\r\n    axisZ.color = new Color3(0, 0, 1)\r\n  }\r\n\r\n  // initialise scene rendering\r\n  render(){\r\n    return <BabylonScene onSceneMount={this.onSceneMount} onKeyDown={this.onKeyDown} onKeyUp={this.onKeyUp} onRender={this.resetPosAndAngle}/>\r\n  }\r\n}\r\n\r\nexport default Playground\r\n","import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport Playground from './components/Playground'\n\nconst App = () => <Playground />\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}