(this.webpackJsonpjoust=this.webpackJsonpjoust||[]).push([[0],{110:function(e,t,i){e.exports=i(121)},115:function(e,t,i){},116:function(e,t,i){e.exports=i.p+"static/media/logo.25bf045c.svg"},117:function(e,t,i){},121:function(e,t,i){"use strict";i.r(t);var n=i(38),o=i.n(n),r=i(102),a=i.n(r),s=(i(115),i(116),i(117),i(66)),c=i(67),l=i(73),h=i(68),p=i(51),u=i(74),g=i(109),v=i(23),m=i(0),y=i(107),d=i(103),w=i(85),f=i(104),I=i(53),k=(i(118),i(54)),x=i(76),b=i(12),D=i(77),M=i(105),W=i(87),C=i(86),S=i(44),B=i(17),L=i(108),A=(i(122),i(119),i(21)),P=i(19),O=(i(120),i(106)),z=i.n(O);window.earcut=z.a;var E=function(e){function t(){var e,i;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(i=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).onResizeWindow=function(){i.engine&&i.engine.resize()},i.onCanvasLoaded=function(e){if(null!==e){i.canvas=e;var t=function(e){return e.preventDefault()};i.canvas.onwheel=t,i.canvas.onmousewheel=t,i.canvas.focus()}},i.onKeyDown=function(e){i.props.onKeyDown(e)},i.onKeyUp=function(e){i.props.onKeyUp(e)},i}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.engine=new A.a(this.canvas,this.props.antialias,this.props.engineOptions,this.props.adaptToDeviceRatio),this.scene=new P.a(this.engine),this.props.onSceneMount({scene:this.scene,engine:this.engine,canvas:this.canvas}),this.engine.runRenderLoop((function(){e.scene&&(e.props.onRender(),e.scene.render())})),window.addEventListener("resize",this.onResizeWindow)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResizeWindow)}},{key:"render",value:function(){return o.a.createElement("canvas",{ref:this.onCanvasLoaded,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,style:{width:"100%",height:"100%",outline:"none"}})}}]),t}(o.a.Component);E.defaultProps={antialias:!0,adaptToDeviceRatio:!1};var R=E,T=!1,_=function(e){function t(e){var i;return Object(s.a)(this,t),(i=Object(l.a)(this,Object(h.a)(t).call(this,e))).onSceneMount=function(e){var t=e.canvas,n=e.scene;e.engine;window.scene=n,i.scene=n;var o=new m.o(0,-9.81,0),r=new g.a;n.enablePhysics(o,r),i.camera=i.createCamera(n,t),i.createSky(n),i.createDirectionalLight(n),i.createHemisphericLight(n),i.createStaticMesh({scene:n}),T&&i.showWorldAxis({size:5,scene:n})},i.createStaticMesh=function(e){var t=e.scene;i.concreteMaterial=i.createConcreteMaterial(t),i.pbr=i.createBricksMaterial(t),i.land=i.createGround(t),i.createFloor(t),i.ceiling=i.createCeiling(t),i.createLeftWall(t),i.createRightWall(t),i.createBackWall(t),i.createFrontWall(t),i.platform=i.createPlatform(t),i.egg=i.createEgg(t),i.sphere=i.createSphere(t),i.setEggImpostor()},i.onSphereHitEgg=function(e,t){i.egg.physicsImpostor.dispose(),i.egg.parent=i.sphere,i.egg.position=new m.o(1.75,0,0)},i.onSphereHitGround=function(e,t){Math.abs(i.sphere.physicsImpostor.getLinearVelocity().y)<4&&(i.touching=!0)},i.onSpacePressed=function(){var e=i.getBoost();console.log("spacebar boost"+e),i.sphere.physicsImpostor.applyImpulse(new m.o(.7*i.keyDirection*e,1,0),i.sphere.getAbsolutePosition()),i.resetPosAndAngle(),i.touching=!1},i.onKeyDown=function(e){if(e.preventDefault()," "===e.key)i.onSpacePressed();else if("ArrowRight"===e.key){if(i.keyDirection=1,i.sphere.physicsImpostor.friction=.1,i.land.physicsImpostor.friction=.1,!i.accelerateInterval){var t=Object(p.a)(i);i.accelerateInterval=setInterval((function(){t.accelerate.apply(t)}),200)}}else if("ArrowLeft"===e.key){if(i.keyDirection=-1,i.sphere.physicsImpostor.friction=.1,i.land.physicsImpostor.friction=.1,!i.accelerateInterval){var n=Object(p.a)(i);i.accelerateInterval=setInterval((function(){n.accelerate.apply(n)}),200)}}else if("AltGraph"===e.key&&i.sphere.getChildren().includes(i.egg)){console.log("AltGraph"),i.egg.parent=null,i.egg.position=i.sphere.getAbsolutePosition(),i.egg.position.x+=5*i.keyDirection,i.setEggImpostor(),i.egg.position.z=0;var o=i.egg.physicsImpostor.getLinearVelocity();o.z=0,i.egg.physicsImpostor.setLinearVelocity(o),i.egg.physicsImpostor.setAngularVelocity(new m.o(0,0,0)),i.egg.rotation=new m.o(0,0,0),i.egg.physicsImpostor.applyImpulse(new m.o(20*i.keyDirection,0,0),i.egg.getAbsolutePosition())}},i.onKeyUp=function(e){e.preventDefault(),"ArrowRight"!==e.key&&"ArrowLeft"!==e.key||(i.keyDirection=0,i.accelerateInterval&&(console.log("clearInterval"),clearInterval(i.accelerateInterval),i.accelerateInterval=null),i.sphere.physicsImpostor.friction=1,i.land.physicsImpostor.friction=1)},i.resetPosAndAngle=function(){var e=i.sphere.physicsImpostor.getLinearVelocity();e.z=0,i.sphere.physicsImpostor.setLinearVelocity(e),i.sphere.position.z=0,i.sphere.physicsImpostor.setAngularVelocity(new m.o(0,0,0)),i.sphere.rotation=new m.o(0,0,0)},i.showWorldAxis=function(e){var t=e.size,i=e.scene;D.a.CreateLines("axisX",{points:[m.o.Zero(),new m.o(t,0,0)]},i).color=new m.c(1,0,0),D.a.CreateLines("axisY",{points:[m.o.Zero(),new m.o(0,t,0)]},i).color=new m.c(0,1,0),D.a.CreateLines("axisZ",{points:[m.o.Zero(),new m.o(0,0,t)]},i).color=new m.c(0,0,1)},i.keyDirection=0,i.touching=!0,i.levelHeight=40,i.levelWidth=150,i.levelDepth=4,i}return Object(u.a)(t,e),Object(c.a)(t,[{key:"createCamera",value:function(e,t){var i=new y.a("arc-camera",-Math.PI/2,Math.PI/2,60,new m.o(0,0,0),e);return i.fov=.6,i.minZ=0,i}},{key:"createSky",value:function(e){var t=new L.a("sky-material",e);t.backFaceCulling=!1,t.luminance=.8,t.inclination=.18,t.azimuth=.27,S.a.CreateBox("skybox",{size:1e3},e).material=t}},{key:"createDirectionalLight",value:function(e){var t=new d.a("direct",new m.o(-1,-3,3),e);t.position=new m.o(10,this.levelHeight,-10),this.sg=new I.a(1024,t),this.sg.usePoissonSampling=!0}},{key:"createHemisphericLight",value:function(e){new f.a("hemi",new m.o(1,2,1),e).intensity=.3}},{key:"createLights",value:function(e){var t=new w.a("light",new m.o(3*this.levelWidth/4,9,-200),e),i=new w.a("light",new m.o(3*-this.levelWidth/4,32,-200),e);t.intensity=.7,i.intensity=.3}},{key:"createGround",value:function(e){var t=W.a.CreateGround("land",{width:this.levelWidth,height:this.levelDepth,sideOrientation:B.a.DOUBLESIDE},e);return t.physicsImpostor=new v.a(t,v.a.PlaneImpostor,{mass:0,restitution:0,stiffness:0,friction:1},e),t.visibility=0,t}},{key:"createFloor",value:function(e){var t=this.getBoxWrapUV(this.levelWidth,2,this.levelDepth,5),i=S.a.CreateBox("land",{width:this.levelWidth,height:2,sideOrientation:B.a.DOUBLESIDE,depth:this.levelDepth,faceUV:t},e);i.position.y=-1,i.material=this.concreteMaterial,i.receiveShadows=!0}},{key:"createCeiling",value:function(e){var t=new k.a("default-material",e);t.diffuseColor=new m.c(1,1,1);var i=S.a.CreateBox("ceiling",{width:this.levelWidth,depth:this.levelDepth,height:.2},e);return i.position.y=40,i.material=t,i.physicsImpostor=new v.a(i,v.a.BoxImpostor,{mass:0},e),i}},{key:"createLeftWall",value:function(e){var t=new k.a("default-material",e);t.diffuseColor=new m.c(1,1,1);var i=S.a.CreateBox("leftWall",{width:this.levelHeight,depth:this.levelDepth,height:.2},e);i.rotation.z=Math.PI/2,i.position.y=20,i.position.x=-this.levelWidth/2,i.material=t,i.physicsImpostor=new v.a(i,v.a.BoxImpostor,{mass:0,restitution:.9},e),i.receiveShadows=!0}},{key:"createRightWall",value:function(e){var t=new k.a("default-material",e);t.diffuseColor=new m.c(1,1,1);var i=S.a.CreateBox("rightWall",{width:this.levelHeight,depth:this.levelDepth,height:.2},e);i.rotation.z=Math.PI/2,i.position.y=20,i.position.x=this.levelWidth/2,i.material=t,i.physicsImpostor=new v.a(i,v.a.BoxImpostor,{mass:0,restitution:.9},e),i.receiveShadows=!0}},{key:"createBricksMaterial",value:function(e){var t=new x.a("bricks",e);return t.forceIrradianceInFragment=!0,t.albedoTexture=new b.a("textures/bricks_rustic_albedo.png",e),t.bumpTexture=new b.a("textures/bricks_rustic_normal.png",e),t.useRoughnessFromMetallicTextureAlpha=!1,t.useRoughnessFromMetallicTextureGreen=!0,t.useMetallnessFromMetallicTextureBlue=!0,t.metallicTexture=new b.a("textures/bricks_rustic_metallic_roughness.png",e),t.invertNormalMapX=!0,t.invertNormalMapY=!0,t}},{key:"createBackWall",value:function(e){var t=this;W.a.CreateGroundFromHeightMap("backWall","textures/bricks_rustic_height.png",{height:20,width:20,subdivisions:200,maxHeight:.2,onReady:function(i){i.rotation.x=-Math.PI/2,i.material=t.pbr,i.receiveShadows=!0;for(var n=new B.a("tmpBackWall",e),o=0;o<t.levelWidth;o+=20)for(var r=0;r<t.levelHeight;r+=20)if(0===o&&0===r)i.parent=n,i.position=new m.o(o,r,0);else{var a=i.createInstance("wallTile"+o+"_"+r);a.parent=n,a.position=new m.o(o,r,0)}n.position.z=t.levelDepth/2,n.position.y=t.levelHeight/2-10,n.position.x=-t.levelWidth/2,n.physicsImpostor=new v.a(n,v.a.BoxImpostor,{mass:0,restitution:.1,friction:.01},e)}},e)}},{key:"createFrontWall",value:function(e){var t=M.a.CreatePlane("frontWall",{height:this.levelWidth,width:this.levelHeight,sideOrientation:B.a.BACKSIDE},e);t.rotation.z=Math.PI/2,t.position.z=-this.levelDepth/2,t.position.y=this.levelHeight/2,t.physicsImpostor=new v.a(t,v.a.BoxImpostor,{mass:0,restitution:.1,friction:.01},e)}},{key:"createConcreteMaterial",value:function(e){var t=new x.a("concrete",e);return t.forceIrradianceInFragment=!0,t.albedoTexture=new b.a("textures/concrete_worn_albedo.png",e),t.bumpTexture=new b.a("textures/concrete_worn_normal.png",e),t.useRoughnessFromMetallicTextureAlpha=!1,t.useRoughnessFromMetallicTextureGreen=!0,t.useMetallnessFromMetallicTextureBlue=!0,t.metallicTexture=new b.a("textures/concrete_worn_metallic_roughness.png",e),t.invertNormalMapX=!0,t.invertNormalMapY=!0,t}},{key:"getBoxWrapUV",value:function(e,t,i,n){for(var o=new Array(6),r=0;r<6;r++)0===r||1===r?o[r]=new m.p(0,0,e/n,t/n):2===r||3===r?o[r]=new m.p(0,0,t/n,i/n):4!==r&&5!==r||(o[r]=new m.p(0,0,i/n,e/n));return o}},{key:"createPlatform",value:function(e){var t=this.getBoxWrapUV(20,2,this.levelDepth,5),i=S.a.CreateBox("ceiling",{width:20,depth:this.levelDepth,height:2,faceUV:t},e);return i.position.y=10,i.material=this.concreteMaterial,i.physicsImpostor=new v.a(i,v.a.BoxImpostor,{mass:0,restitution:.1,friction:.01},e),this.sg.getShadowMap().renderList.push(i),i.receiveShadows=!0,i}},{key:"createEgg",value:function(e){var t=new k.a("default-material",e);t.diffuseColor=new m.c(1,1,1);var i=C.a.CreateSphere("egg",{diameter:1.5,segments:16},e);return i.material=t,i.position.y=15,this.sg.getShadowMap().renderList.push(i),i}},{key:"createSphere",value:function(e){var t=new x.a("default-material",e);t.albedoColor=new m.c(1,0,0),t.metallic=.9,t.roughness=.3;var i=C.a.CreateSphere("sphere",{diameter:2},e);return i.position.y=2,i.material=t,this.camera.parent=i,i.physicsImpostor=new v.a(i,v.a.SphereImpostor,{mass:.2,restitution:0,friction:1,stiffness:0},e),i.physicsImpostor.registerOnPhysicsCollide([this.platform.physicsImpostor,this.land.physicsImpostor],this.onSphereHitGround),this.sg.getShadowMap().renderList.push(i),i}},{key:"setEggImpostor",value:function(e){this.egg.physicsImpostor=new v.a(this.egg,v.a.SphereImpostor,{mass:1,restitution:.2,friction:.3},this.scene),this.sphere.physicsImpostor.registerOnPhysicsCollide(this.egg.physicsImpostor,this.onSphereHitEgg)}},{key:"getBoost",value:function(){var e=this.sphere.physicsImpostor.getLinearVelocity().x;return e/Math.abs(e)===this.keyDirection?1:2}},{key:"isNotSpeeding",value:function(){return this.sphere.physicsImpostor.getLinearVelocity().x*this.keyDirection<7}},{key:"isTouchingGround",value:function(){return this.touching}},{key:"accelerate",value:function(){if(this.resetPosAndAngle(),0!==this.keyDirection&&this.isNotSpeeding()&&this.isTouchingGround()){var e=this.getBoost();this.sphere.physicsImpostor.applyImpulse(new m.o(1*this.keyDirection*e,0,0),this.sphere.getAbsolutePosition())}}},{key:"render",value:function(){return o.a.createElement(R,{onSceneMount:this.onSceneMount,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onRender:this.resetPosAndAngle})}}]),t}(o.a.Component),H=function(){return o.a.createElement(_,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[110,1,2]]]);
//# sourceMappingURL=main.31712e0a.chunk.js.map